# –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞ Auto Strategy

## –û–ø–∏—Å–∞–Ω–∏–µ

Auto Strategy - —ç—Ç–æ –º–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∞—è –∏–≥—Ä–∞, –≥–¥–µ –∏–≥—Ä–æ–∫–∏ —É–ø—Ä–∞–≤–ª—è—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —é–Ω–∏—Ç–∞–º–∏ –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –∫–∞—Ä—Ç—ã, –¥–æ–±—ã—á–∏ —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ –ø—Ä–æ—Ç–∏–≤–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞–º.

## –û—Å–Ω–æ–≤–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**: –Æ–Ω–∏—Ç—ã –¥–µ–π—Å—Ç–≤—É—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ –∑–∞–¥–∞–Ω–Ω—ã–º –ø—É—Ç—è–º
- **Real-time –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ**: WebSocket –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- **–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∫–∞—Ä—Ç—ã**: –°–∏—Å—Ç–µ–º–∞ "—Ç—É–º–∞–Ω–∞ –≤–æ–π–Ω—ã" —Å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–º –æ—Ç–∫—Ä—ã—Ç–∏–µ–º —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏
- **–†–µ—Å—É—Ä—Å–Ω–∞—è —ç–∫–æ–Ω–æ–º–∏–∫–∞**: –î–æ–±—ã—á–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏ (–∑–æ–ª–æ—Ç–æ, –∫—Ä–∏—Å—Ç–∞–ª–ª—ã)
- **–°—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**: –†–∞–∑–º–µ—â–µ–Ω–∏–µ –∑–¥–∞–Ω–∏–π –∏ –ø—Ä–æ–∫–ª–∞–¥—ã–≤–∞–Ω–∏–µ –ø—É—Ç–µ–π

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### Monorepo —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
auto-strategy/
‚îú‚îÄ‚îÄ apps/
‚îÇ   ‚îú‚îÄ‚îÄ backend/          # NestJS API —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îî‚îÄ‚îÄ frontend/         # React –∫–ª–∏–µ–Ω—Ç
‚îú‚îÄ‚îÄ libs/                 # –û–±—â–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ domain-primitives/ # Value Objects
‚îÇ   ‚îú‚îÄ‚îÄ nest-jwt/         # JWT –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ logger/           # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ utils/            # –£—Ç–∏–ª–∏—Ç—ã
‚îî‚îÄ‚îÄ docs/                 # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
```

### Backend –º–æ–¥—É–ª–∏

- **User**: –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- **GameSession**: –ò–≥—Ä–æ–≤—ã–µ —Å–µ—Å—Å–∏–∏ –∏ –∏—Ö –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª
- **Map**: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–≤—ã–º–∏ –∫–∞—Ä—Ç–∞–º–∏
- **Player**: –ò–≥—Ä–æ–∫–∏ –≤ —Å–µ—Å—Å–∏—è—Ö –∏ –∏—Ö —Ä–µ—Å—É—Ä—Å—ã
- **Building**: –ó–¥–∞–Ω–∏—è –∏ –∏—Ö –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ
- **Unit**: –Æ–Ω–∏—Ç—ã –∏ –∏—Ö –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### Backend

- **Framework**: NestJS
- **Database**: PostgreSQL —Å Prisma ORM
- **Authentication**: JWT —Å HttpOnly cookies
- **WebSocket**: Socket.io –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- **Validation**: class-validator –∏ class-transformer
- **Documentation**: Swagger/OpenAPI

### Frontend

- **Framework**: React —Å TypeScript
- **Build Tool**: Vite
- **State Management**: React Context + Hooks
- **Styling**: CSS Modules

### –û–±—â–∏–µ

- **Package Manager**: pnpm
- **Monorepo**: Turborepo
- **Testing**: Jest
- **Linting**: ESLint

## API Endpoints

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

- `POST /v1/users` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- `POST /v1/users/login` - –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É
- `GET /v1/users/me` - –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ò–≥—Ä–æ–≤—ã–µ —Å–µ—Å—Å–∏–∏

- `POST /v1/sessions` - –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏
- `GET /v1/sessions/{id}` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏
- `POST /v1/sessions/{id}/players` - –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∫ —Å–µ—Å—Å–∏–∏
- `POST /v1/sessions/{id}/buildings` - –°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ –∑–¥–∞–Ω–∏–π

## –°—Ç–∞—Ç—É—Å—ã –∏–≥—Ä–æ–≤—ã—Ö —Å–µ—Å—Å–∏–π

- `GENERATING_MAP` - –ö–∞—Ä—Ç–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è
- `WAITING` - –û–∂–∏–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤
- `IN_PROGRESS` - –ò–≥—Ä–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ
- `FINISHED` - –ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞

## WebSocket —Å–æ–±—ã—Ç–∏—è

- `map.generate` - –ó–∞–ø—É—Å–∫ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–∞—Ä—Ç—ã
- `map.generated` - –ö–∞—Ä—Ç–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞
- `player.created` - –°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π –∏–≥—Ä–æ–∫
- `player.joining` - –ò–≥—Ä–æ–∫ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è
- `game-session.changed` - –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–µ—Å—Å–∏–∏

## –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ (—Ç–µ–∫—É—â–∞—è —Å–µ—Å—Å–∏—è)

- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—É—Ç–∏ API –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (`/v1/users` –≤–º–µ—Å—Ç–æ `/api/v1/auth/*`)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã —Å—Ç–∞—Ç—É—Å—ã –∏–≥—Ä–æ–≤—ã—Ö —Å–µ—Å—Å–∏–π —Å–æ–≥–ª–∞—Å–Ω–æ —Ä–µ–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ PlayerDto (isWinner –∫–∞–∫ Boolean, –∞ –Ω–µ Boolean | undefined)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ MapDto —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ spawnPoints
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã WebSocket —Å–æ–±—ã—Ç–∏—è —Å–æ–≥–ª–∞—Å–Ω–æ —Ä–µ–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å –∞–∫—Ç—É–∞–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –º–æ–¥—É–ª–µ–π
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –∫–∞—Å—Ç–æ–º–Ω—ã–π –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä `@UserId()` –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ JWT —Ç–æ–∫–µ–Ω–∞

## –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pnpm install
```

### –ó–∞–ø—É—Å–∫ –≤ development —Ä–µ–∂–∏–º–µ

```bash
# Backend
pnpm --filter backend dev

# Frontend
pnpm --filter frontend dev
```

### –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

```bash
pnpm build
```

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [–ò–≥—Ä–æ–≤–∞—è –º–µ—Ö–∞–Ω–∏–∫–∞](01_game_mechanics.md)
- [–ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö](02_data_models.md)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã](03_system_architecture.md)
- [–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è API](04_api_specification.md)
- [–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏](05_auth_analytics.md)
- [–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏–≥—Ä–æ–≤—ã—Ö —Å–µ—Å—Å–∏–π](06_game_session_analytics.md)
- [–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∫–∞—Ä—Ç](07_map_analytics.md)
- [–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏–≥—Ä–æ–∫–æ–≤](08_player_analytics.md)
- **[–ü–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ —Å–∏—Å—Ç–µ–º—ã –∫–∞—Ä—Ç](09_map_optimization_refactoring_plan.md)** ‚ö†Ô∏è TODO
- **[–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–∞—Ä—Ç—ã](10_map_generation_refactoring_plan.md)** ‚ö†Ô∏è TODO
- **[–°–∏—Å—Ç–µ–º–∞ —Å–ª–æ–µ–≤–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–∞—Ä—Ç](11_layered_map_generation_system.md)** üí° –ö–û–ù–¶–ï–ü–¶–ò–Ø
