# Модели данных (Сущности)

Этот документ описывает основные сущности данных, используемые в приложении. Они служат основой для схемы базы данных (Prisma) и для управления состоянием на клиенте (Zustand).

---

### Сущность: `User` (Пользователь)

**Описание:** Представляет учетную запись пользователя в системе. Не связана напрямую с игровой логикой, используется для аутентификации и авторизации.

**Атрибуты:**

| Поле | Тип данных | Описание | Ограничения/Примечания | Обязательное |
|---|---|---|---|---|
| `id` | UUID | Уникальный идентификатор пользователя | Генерируется системой (PK) | Да |
| `email` | String | Адрес электронной почты | Уникальный, валидный email | Да |
| `password_hash`| String | Хеш пароля | | Да |
| `created_at` | DateTime | Дата и время создания | | Да |
| `updated_at` | DateTime | Дата и время обновления | | Да |

---

### Сущность: `GameSession` (Игровая сессия)

**Описание:** Представляет одну игровую партию. Содержит общее состояние игры, в которой участвует несколько игроков.

**Атрибуты:**

| Поле | Тип данных | Описание | Ограничения/Примечания | Обязательное |
|---|---|---|---|---|
| `id` | UUID | Уникальный идентификатор сессии | Генерируется системой (PK) | Да |
| `map_id` | UUID | Идентификатор карты (FK) | Ссылка на `Map.id` | Нет |
| `status` | Enum | Текущий статус игры | `WAITING`, `IN_PROGRESS`, `FINISHED` | Да |
| `created_at` | DateTime | Дата и время создания | | Да |
| `finished_at`| DateTime | Дата и время завершения | | Нет |

---

### Сущность: `Player` (Игрок)

**Описание:** Представляет игрока внутри конкретной `GameSession`. Связывает `User` с его игровым состоянием.

**Атрибуты:**

| Поле | Тип данных | Описание | Ограничения/Примечания | Обязательное |
|---|---|---|---|---|
| `id` | UUID | Уникальный идентификатор игрока | Генерируется системой (PK) | Да |
| `user_id` | UUID | Идентификатор пользователя (FK) | Ссылка на `User.id` | Да |
| `game_session_id`| UUID | Идентификатор игровой сессии (FK)| Ссылка на `GameSession.id` | Да |
| `resources` | JSON | Объект с количеством ресурсов | `{"gold": 100, "crystals": 0}` | Да |
| `is_winner` | Boolean | Флаг, был ли игрок победителем | | Нет |

---

### Сущность: `Building` (Здание)

**Описание:** Представляет здание, построенное игроком на карте.

**Атрибуты:**

| Поле | Тип данных | Описание | Ограничения/Примечания | Обязательное |
|---|---|---|---|---|
| `id` | UUID | Уникальный идентификатор здания | Генерируется системой (PK) | Да |
| `player_id` | UUID | Идентификатор игрока-владельца (FK) | Ссылка на `Player.id` | Да |
| `type` | Enum | Тип здания | `SPAWN`, `BARRACKS`, `MINE` и т.д. | Да |
| `position` | JSON | Координаты на карте | `{"x": 10, "y": 25}` | Да |
| `path` | JSON | Массив координат пути для юнитов | `[{"x": 10, "y": 26}, ...]` | Нет |

---

### Сущность: `Unit` (Юнит)

**Описание:** Представляет юнита, созданного зданием.

**Атрибуты:**

| Поле | Тип данных | Описание | Ограничения/Примечания | Обязательное |
|---|---|---|---|---|
| `id` | UUID | Уникальный идентификатор юнита | Генерируется системой (PK) | Да |
| `player_id` | UUID | Идентификатор игрока-владельца (FK) | Ссылка на `Player.id` | Да |
| `building_id`| UUID | ID здания, которое его создало (FK) | Ссылка на `Building.id` | Да |
| `type` | Enum | Тип юнита | `DIGGER`, `MINER`, `WARRIOR` | Да |
| `position` | JSON | Текущие координаты на карте | `{"x": 11, "y": 28}` | Да |
| `health` | Integer | Текущее здоровье юнита | | Да |

---

### Сущность: `Map` (Карта)

**Описание:** Представляет игровую карту с ее структурой.

**Атрибуты:**

| Поле | Тип данных | Описание | Ограничения/Примечания | Обязательное |
|---|---|---|---|---|
| `id` | UUID | Уникальный идентификатор карты | Генерируется системой (PK) | Да |
| `name` | String | Название карты | | Да |
| `size` | JSON | Размеры карты | `{"width": 100, "height": 100}`| Да |
| `terrain_data`| JSON | Данные о ландшафте (расположение пород, ресурсов) | | Да |
| `spawn_points`| JSON | Координаты стартовых позиций для игроков| `[{"x": 10, "y": 10}, ...]` | Да |